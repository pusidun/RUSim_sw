/*
 * ad9361_cfg.cc
 *
 *  Created on: 2017年12月12日
 *      Author: dg
 */

#include "ad9361_cfg.h"
#include "eeprom.h"
#include "math.h"
u8 RXTIA_ADC = 0;//0:CONFIG_RXTIA  1:CONFIG_ADC
u32 chipSelect = 0x0;//GSM :0x2 LTE:0x1
u32 configStatus = XST_SUCCESS;
u32 waitcalStatus = XST_FAILURE;

u8 SPIRead(u16 addr) {
	u32 spiVal = 0x00;
	u32 regVal;
	//read 0x0024 if bit7:6 is 0x11 , 表示SPI控制器是空闲状态
	regVal = Read_Data(BaseAddr, 0x0024);
	if ((regVal & 0xC0) == 0xC0) {
		Write_Data(BaseAddr, 0x002c, chipSelect); //chip selesct
		//写入地址到0x001c ,地址位宽是16bit;
		Write_Data(BaseAddr, 0x001c, addr);
		//配置 write 0x0024 bit 1:0 写成 0x01
		regVal = Read_Data(BaseAddr, 0x0024);
		regVal &= 0xFC;
		regVal |= 0x01;
		Write_Data(BaseAddr, 0x0024, regVal);
		//配置0x0028 , bit1 先写1 再写0
		Write_Data(BaseAddr, 0x0028, 0x01);
		delay_ad9362(2);
		Write_Data(BaseAddr, 0x0028, 0x00);
	}
	//read 0x0024 if bit7:6 is 0x11 , 表示SPI控制器是空闲状态，可以读写
	regVal = Read_Data(BaseAddr, 0x0024);
	if ((regVal & 0xC0) == 0xC0) {
		//配置 write 0x0024 bit 1:0 写成 0x00
		regVal = Read_Data(BaseAddr, 0x0024);
		regVal &= 0xFC;
		regVal |= 0x00;
		Write_Data(BaseAddr, 0x0024, regVal);
		//配置0x0028 , bit1 先写1 再写0
		Write_Data(BaseAddr, 0x0028, 0x01);
		delay_ad9362(2);
		Write_Data(BaseAddr, 0x0028, 0x00);
		//read 0x0024 if bit7:6 is 0x11 , 表示SPI控制器是空闲状态，表示读取完成
		regVal = Read_Data(BaseAddr, 0x0024);
		if ((regVal & 0xC0) == 0xC0) {
			//从0x0020 这个寄存器读取数据
			Write_Data(BaseAddr, 0x002c, 0x0);		//chip select
			spiVal = Read_Data(BaseAddr, 0x0020);
		}
	}
	return spiVal;
}

void SPIWrite(u16 addr, u8 val) {
	u32 regVal;
	addr |= 0x8000; //set bit 15 to 1,means writing
	regVal = Read_Data(BaseAddr, 0x0024);
	//read 0x0024 if bit7:6 is 0x11 , 表示SPI控制器是空闲状态，可以读写
	if ((regVal & 0xC0) == 0xC0) {
		delay_ad9362(2);
		Write_Data(BaseAddr, 0x002c, chipSelect); //chip select
		//写入地址到0x001c ,地址位宽是16bit
		Write_Data(BaseAddr, 0x001c, addr);
		//配置 write 0x0024 bit 1:0 写成 0x01
		regVal = Read_Data(BaseAddr, 0x0024);
		regVal &= 0xFC;
		regVal |= 0x01;
		Write_Data(BaseAddr, 0x0024, regVal);
		//配置0x0028 , bit1 先写1 再写0
		Write_Data(BaseAddr, 0x0028, 0x01);
		delay_ad9362(2);
		Write_Data(BaseAddr, 0x0028, 0x00);
	}
	//read 0x0024 if bit7:6 is 0x11 , 表示SPI控制器是空闲状态，可以读写
	regVal = Read_Data(BaseAddr, 0x0024);
	if ((regVal & 0xC0) == 0xC0) {
		//写入数据到0x001c ,数据位宽是8bit
		Write_Data(BaseAddr, 0x001c, val);
		//配置 write 0x0024 bit 1:0 写成 0x00
		regVal = Read_Data(BaseAddr, 0x0024);
		regVal &= 0xFC;
		regVal |= 0x00;
		Write_Data(BaseAddr, 0x0024, regVal);
		//配置0x0028 , bit1 先写1 再写0
		Write_Data(BaseAddr, 0x0028, 0x01);
		delay_ad9362(2);
		Write_Data(BaseAddr, 0x0028, 0x00);
		if ((regVal & 0xC0) == 0xC0) {
			//读取数据从0x0020 这个寄存器
			Write_Data(BaseAddr, 0x002c, 0x0);
		}
	}
	//delay 1ms
	delay_ad9362(2000);
}

/*
 * @param: u32 time: 微秒
 */
void delay_ad9362(u32 time) {
	for (u32 i = 0; i < time; i++)
		for (u32 j = 0; j < 10; j++)
			;
}

int spi_reg_verity(u32 addr, u32 val) {
	u32 regVal = Read_Data(BaseAddr, addr);
	if (regVal == val)
		return XST_SUCCESS;
	else
		return XST_FAILURE;
}

void SPIRead_HLevel(u16 addr) {
	u8 regVal = 0x00;
	if (addr == 0x05e) {
		// Check BBPLL locked status  (0x05E[7]==1 is locked)
		regVal = SPIRead(addr);
		regVal = regVal >> 0x7;
		if ((regVal & 0x1) != 0x1);
			//printf("BBPLL is not locked\n");
	} else if (addr == 0x247) {
		// Check RX RF PLL lock status (0x247[1]==1 is locked)
		regVal = SPIRead(addr);
		if ((regVal & 0x1) != 0x1);
			//printf("RX RF PLL is not locked\n");
	} else if (addr == 0x287) {
		// Check TX RF PLL lock status (0x287[1]==1 is locked)
		regVal = SPIRead(addr);
		if ((regVal & 0x1) != 1);
			//printf("Tx RF PLL is not locked\n");
	}
	else if(addr == 0x1e6)
	{
		u8 reg1EB=0, reg1EC=0, reg1E6=0;
		reg1EB = SPIRead(0x1EB);
		reg1EC = SPIRead(0x1EC);
		reg1E6 = SPIRead(0x1E6);
		if(RXTIA_ADC == 0)//CONFIG_RXTIA
		{
			RXTIA_ADC = 1;

			// calculation
			u16 Cbbf = (reg1EB * 160)  + (reg1EC * 10) + 140;
			u16 R2346 = 18300 * (reg1E6 & 0x7);
			double CTIA_fF = (Cbbf * R2346 * 0.56) / 3500;
			u16 tmpBBBW_MHz = 20;

			u8 reg1DB=0;
			u16 U16_BW_MHz = (tmpBBBW_MHz);
			if( U16_BW_MHz <= 3 )
			{
				reg1DB = 0xE0;
			}
			else if( U16_BW_MHz > 3 && U16_BW_MHz <= 10 )
			{
			   reg1DB = 0x60;
			}
			else
			{
			   reg1DB = 0x20;
			}

			u8 temp = 0;
			u8 reg1DC = 0, reg1DE = 0, reg1DD = 0, reg1DF = 0;
			if( CTIA_fF > 2920.0 )
			{
				reg1DC = 0x40;
				reg1DE = 0x40;
				temp = (u8)round((CTIA_fF - 400) / 320) ;
				temp = temp < 127 ? temp : 127;
				reg1DD = temp;
				reg1DF = temp;
			}
			else
			{
				temp = (u8) round((CTIA_fF - 400) / 40 ) + 0x40;
				reg1DC = temp;
				reg1DE = temp;
				reg1DD = 0;
				reg1DF = 0;
			}

			// Update data of corresponding registers and they will be
			// written to AD9362 registers
			if(chipSelect == 0x1)//lte
			{
				eeWrAD(0x1518, 0xA, reg1DB, 0x1DB);//0x20
				eeWrAD(0x151c, 0xA, reg1DD, 0x1DD);//0
				eeWrAD(0x1520, 0xA, reg1DF, 0x1DF);//0
				eeWrAD(0x1524, 0xA, reg1DC, 0x1DC);//0x46
				eeWrAD(0x1528, 0xA, reg1DE, 0x1DE);//0x46
			}
			else if(chipSelect == 0x2)//gsm
			{
				eeWrAD(0x37dc, 0xA, reg1DB, 0x1DB);
				eeWrAD(0x37e0, 0xA, reg1DD, 0x1DD);
				eeWrAD(0x37e4, 0xA, reg1DF, 0x1DF);
				eeWrAD(0x37e8, 0xA, reg1DC, 0x1DC);
				eeWrAD(0x37ec, 0xA, reg1DE, 0x1DE);
			}
		}
		else if(RXTIA_ADC == 1)//CONFIG_ADC
		{
			RXTIA_ADC =0;
			double tmpBBBW_MHz = 0;
			if(chipSelect == 0x1)//lte
			{
				tmpBBBW_MHz = 40;
			}
			else if(chipSelect == 0x2)//gsm
			{
				tmpBBBW_MHz = 20;
			}

			//calibration
			double scale_snr_dB = (FsADC < 80 ? 0 : 2);
			u8 rxbbf_c3_msb = reg1EB, rxbbf_c3_lsb = reg1EC, rxbbf_r2346 = reg1E6;
			double d1 = (1.4 * 2 * 3.14);
			double d2 = (18300 * rxbbf_r2346);
			double d3 = 160e-15 * rxbbf_c3_msb + 10e-15 * rxbbf_c3_lsb + 140e-15;
			double d4 = tmpBBBW_MHz * 1.0e6;
			double d5 = 1.0;
			if( tmpBBBW_MHz > 18.0 )
			{
				d5 = 1.0 + 0.01 * (tmpBBBW_MHz - 18.0);
			}
			double rc_timeConst = 1.0 / ( d1 * d2 * d3 * d4 * d5 );

			double scale_res = sqrt( 1 / rc_timeConst);
			double scale_cap = scale_res;
			double scale_snr = pow(10, scale_snr_dB * 0.1 );
			double maxsnr = 640.0 / 160;

			u8 reg207,reg208,reg209,reg20a,reg20b,reg20c,reg20d,reg20e;
			u8 reg20f,reg210,reg211,reg212,reg213,reg214,reg215,reg216,reg217;
			u8 reg218,reg219,reg21a,reg21b,reg21c,reg21d,reg21e,reg21f,reg220,reg221,reg222;

			// calculate the value of 0x207
			double regVal = 0.0;
			double minVal = sqrt( maxsnr * FsADC / 640 );
			minVal = minVal < 1.0 ? minVal : 1.0;
			regVal = floor(-0.5 + 80 * scale_snr * scale_res * minVal);
			regVal = regVal < 124.0 ? regVal : 124.0;
			reg207 = regVal;

			// calculate the value of 0x208
			regVal = floor( 0.5 + (20 * 640 / FsADC) * (reg207 / 80) / (scale_res * scale_cap) );
			regVal = regVal < 255.0 ? regVal : 255.0;
			reg208 = regVal;

			// calculate the value of 0x20A
			regVal = floor(-0.5 + 77 * scale_res * minVal);
			regVal = regVal < 127.0 ? regVal : 127.0;
			reg20a = regVal;

			// calculate the value of 0x209
			regVal = floor( 0.8 * reg20a);
			regVal = regVal < 127.0 ? regVal : 127.0;
			reg209 = regVal;


			// calculate the value of 0x20B
			regVal = floor( 0.5 + 20 * (640 / FsADC) );
			regVal = regVal < 255.0 ? regVal : 255.0;
			reg20b = regVal;

			// calculate the value of 0x20C
			regVal = floor( -0.5 + 80 * scale_res * minVal );
			regVal = regVal < 127.0 ? regVal : 127.0;
			reg20c = regVal;

			// calculate the value of 0x20D
			regVal = floor( -1.5 + 20 * (640 / FsADC) * (regVal / 80) / (scale_res * scale_cap) );
			regVal = regVal < 255.0 ? regVal : 255.0;
			reg20d = regVal;

			// calculate the value of 0x20E
			regVal = 21 * floor( 0.1 * 640 / FsADC );
			reg20e = regVal;

			// calculate the value of 0x20F
			regVal = (u8)(1.025 * reg207);
			regVal = regVal < 127.0 ? regVal : 127.0;
			reg20f = regVal;

			// calculate the value of 0x210
			double maxVal = (640 / FsADC) / maxsnr;
			maxVal = maxVal < 1.0 ? 1.0 : maxVal;
			regVal = floor( reg20f * (0.98 + 0.02 * maxVal) );
			regVal = regVal < 127.0 ? regVal : 127.0;
			reg210 = regVal;

			// calculate the value of 0x211
			reg211 = reg20f;

			// calculate the value of 0x212
			regVal = (u8)( 0.975 * reg20a );
			regVal = regVal < 127.0 ? regVal : 127.0;
			reg212 = regVal;

			// calculate the value of 0x213
			regVal = floor( reg212  * (0.98 + 0.02 * maxVal) );
			regVal = regVal < 127.0 ? regVal : 127.0;
			reg213 = regVal;

			// calculate the value of 0x214
			reg214 = reg212;

			// calculate the value of 0x215
			regVal = (u8)(0.975 * reg20c );
			reg215 = regVal < 127.0 ? regVal : 127.0;

			// calculate the value of 0x216
			regVal = floor( reg215  * (0.98 + 0.02 * maxVal) );
			reg216 = regVal < 127.0 ? regVal : 127.0;

			// calculate the value of 0x217
			reg217 = reg216;

			// calculate the value of 0x218
			reg218 = 0x2E;

			// calculate the value of 0x219
			minVal = 63 * (FsADC / 640 );
			minVal = minVal < 63 ? minVal : 63;
			regVal = floor(128 + minVal);
			reg219 = regVal;

			// calculate the value of 0x21A
			regVal = floor(0 + minVal * (0.92 + 0.08 * (640 / FsADC)));
			reg21a = regVal;

			// calculate the value of 0x21B
			minVal = 32 * sqrt( FsADC / 640 );
			minVal = minVal < 63 ? minVal : 63;
			regVal = floor(0 + minVal);
			reg21b = regVal;

			// calculate the value of 0x21C
			reg21c =reg219;

			// calculate the value of 0x21D
			reg21d =reg21a;

			// calculate the value of 0x21E
			reg21e = reg21b;

			// calculate the value of 0x21F
			reg21f = reg219;

			// calculate the value of 0x220
			reg220 = reg21a;

			// calculate the value of 0x221
			minVal = 63 * sqrt( FsADC / 640 );
			minVal = minVal < 63 ? minVal : 63;
			regVal = floor( 0 + minVal );
			reg221 = regVal;

			// calculate the value of 0x222
			regVal = floor( 64 * sqrt( FsADC / 640) );
			regVal = regVal < 127.0 ? regVal : 127.0;
			reg222 = regVal;


			if(chipSelect == 0x1)//lte
			{
				int Status;
				Status=eeWrAD(0x1560, 0xA, reg207, 0x207);
				Status=eeWrAD(0x1564, 0xA, reg208, 0x208);
				Status=eeWrAD(0x1568, 0xA, reg209, 0x209);
				Status=eeWrAD(0x156c, 0xA, reg20a, 0x20A);
				Status=eeWrAD(0x1570, 0xA, reg20b, 0x20B);
				Status=eeWrAD(0x1574, 0xA, reg20c, 0x20C);
				Status=eeWrAD(0x1578, 0xA, reg20d, 0x20D);//0xf
				Status=eeWrAD(0x157c, 0xA, reg20e, 0x20E);//0
				Status=eeWrAD(0x1580, 0xA, reg20f, 0x20F);//0x7f
				Status=eeWrAD(0x1584, 0xA, reg210, 0x210);
				Status=eeWrAD(0x1588, 0xA, reg211, 0x211);
				Status=eeWrAD(0x158c, 0xA, reg212, 0x212);
				Status=eeWrAD(0x1590, 0xA, reg213, 0x213);
				Status=eeWrAD(0x1594, 0xA, reg214, 0x214);
				Status=eeWrAD(0x1598, 0xA, reg215, 0x215);//0x78
				Status=eeWrAD(0x159c, 0xA, reg216, 0x216);//0x78
				Status=eeWrAD(0x15a0, 0xA, reg217, 0x217);//0x78
				Status=eeWrAD(0x15a4, 0xA, reg218, 0x218);
				Status=eeWrAD(0x15a8, 0xA, reg219, 0x219);
				Status=eeWrAD(0x15ac, 0xA, reg21a, 0x21A);
				Status=eeWrAD(0x15b0, 0xA, reg21b, 0x21B);
				Status=eeWrAD(0x15b4, 0xA, reg21c, 0x21C);
				Status=eeWrAD(0x15b8, 0xA, reg21d, 0x21D);
				Status=eeWrAD(0x15bc, 0xA, reg21e, 0x21E);
				Status=eeWrAD(0x15c0, 0xA, reg21f, 0x21F);
				Status=eeWrAD(0x15c4, 0xA, reg220, 0x220);//0x31
				Status=eeWrAD(0x15c8, 0xA, reg221, 0x221);
				Status=eeWrAD(0x15cc, 0xA, reg222, 0x222);
			}
			else if(chipSelect == 0x2)//gsm
			{
				int Status;
				Status=eeWrAD(0x3824, 0xA, reg207, 0x207);
				Status=eeWrAD(0x3828, 0xA, reg208, 0x208);
				Status=eeWrAD(0x382c, 0xA, reg209, 0x209);
				Status=eeWrAD(0x3830, 0xA, reg20a, 0x20A);
				Status=eeWrAD(0x3834, 0xA, reg20b, 0x20B);
				Status=eeWrAD(0x3838, 0xA, reg20c, 0x20C);
				Status=eeWrAD(0x383c, 0xA, reg20d, 0x20D);
				Status=eeWrAD(0x3840, 0xA, reg20e, 0x20E);
				Status=eeWrAD(0x3844, 0xA, reg20f, 0x20F);
				Status=eeWrAD(0x3848, 0xA, reg210, 0x210);
				Status=eeWrAD(0x384c, 0xA, reg211, 0x211);
				Status=eeWrAD(0x3850, 0xA, reg212, 0x212);
				Status=eeWrAD(0x3854, 0xA, reg213, 0x213);
				Status=eeWrAD(0x3858, 0xA, reg214, 0x214);
				Status=eeWrAD(0x385c, 0xA, reg215, 0x215);
				Status=eeWrAD(0x3860, 0xA, reg216, 0x216);
				Status=eeWrAD(0x3864, 0xA, reg217, 0x217);
				Status=eeWrAD(0x3868, 0xA, reg218, 0x218);
				Status=eeWrAD(0x386c, 0xA, reg219, 0x219);
				Status=eeWrAD(0x3870, 0xA, reg21a, 0x21A);
				Status=eeWrAD(0x3874, 0xA, reg21b, 0x21B);
				Status=eeWrAD(0x3878, 0xA, reg21c, 0x21C);
				Status=eeWrAD(0x387c, 0xA, reg21d, 0x21D);
				Status=eeWrAD(0x3880, 0xA, reg21e, 0x21E);
				Status=eeWrAD(0x3884, 0xA, reg21f, 0x21F);
				Status=eeWrAD(0x3888, 0xA, reg220, 0x220);
				Status=eeWrAD(0x388c, 0xA, reg221, 0x221);
				Status=eeWrAD(0x3890, 0xA, reg222, 0x222);
			}
		}
	}
}

int WAIT_CALDONE(u16 index) {
	if (index == 1) {
		// WAIT_CALDONE	BBPLL,2000
		// Wait for BBPLL to lock, Timeout 2sec, Max BBPLL VCO Cal Time: 225.000 us (Done when 0x05E[7]==1)
		for (int i = 0; i < DELAY_TRY_COUNT; i++) {
			u32 reg = SPIRead(0x05E);//0x80
			u8 checkbit = reg & (0x1 << 7);
			if (checkbit == (0x1 << 7)) {
				waitcalStatus = XST_SUCCESS;
				return waitcalStatus;
			}
			else{
				waitcalStatus = XST_FAILURE;
				delay_ad9362(2000000 / DELAY_TRY_COUNT);
			}
		}
		//printf("WAIT_CALDONE	BBPLL,2000 fail.");
		configStatus = XST_FAILURE;
	} else if (index == 2){		//fail 40 8`b0010 1000
		//WAIT_CALDONE	RXCP,100
		// Wait for CP cal to complete, Max RXCP Cal time: 600.000 (us)(Done when 0x244[7]==1)
		for (int i = 0; i < DELAY_TRY_COUNT; i++) {
			u32 reg = SPIRead(0x244);//0xa9
			u8 checkbit = reg & (0x1 << 7);
			if (checkbit == (0x1 << 7)) {
				waitcalStatus = XST_SUCCESS;
				return waitcalStatus;
			}
			else{
				waitcalStatus = XST_FAILURE;
				delay_ad9362(2000000 / DELAY_TRY_COUNT);
			}
		}
		//printf("WAIT_CALDONE	RXCP,100 fail.");
		configStatus = XST_FAILURE;
	} else if (index == 3){		//fail  40 104 8`b0110 1000
		//WAIT_CALDONE	TXCP,100
		// Wait for CP cal to complete, Max TXCP Cal time: 600.000 (us)(Done when 0x284[7]==1)
		for (int i = 0; i < DELAY_TRY_COUNT; i++) {
			u32 reg = SPIRead(0x284);//0xa7 0xa8
			u8 checkbit = reg & (0x1 << 7);
			if (checkbit == (0x1 << 7)) {
				waitcalStatus = XST_SUCCESS;
				return waitcalStatus;
			}
			else{
				waitcalStatus = XST_FAILURE;
				delay_ad9362(2000000 / DELAY_TRY_COUNT);
			}
		}
		//printf("WAIT_CALDONE	TXCP,100 fail.");
		//configStatus = XST_FAILURE;
	} else if (index == 4) {
		//WAIT_CALDONE	RXFILTER,2000
		// Wait for RX filter to tune, Max Cal Time: 5.585 us (Done when 0x016[7]==0)
		for (int i = 0; i < DELAY_TRY_COUNT; i++) {
			u32 reg = SPIRead(0x016);//0x0
			u8 checkbit = reg & (0x1 << 7);
			if (checkbit == 0) {
				waitcalStatus = XST_SUCCESS;
				return waitcalStatus;
			}
			else{
				waitcalStatus = XST_FAILURE;
				delay_ad9362(2000000 / DELAY_TRY_COUNT);
			}
		}
		//printf("WAIT_CALDONE	RXFILTER,2000 fail.");
		configStatus = XST_FAILURE;
	} else if (index == 5) {
		//WAIT_CALDONE	TXFILTER,2000
		// Wait for TX filter to tune, Max Cal Time: 2.889 us (Done when 0x016[6]==0)
		for (int i = 0; i < DELAY_TRY_COUNT; i++) {
			u32 reg = SPIRead(0x016);//0x0
			u8 checkbit = reg & (0x1 << 6);
			if (checkbit == 0) {
				waitcalStatus = XST_SUCCESS;
				return waitcalStatus;
			}
			else{
				waitcalStatus = XST_FAILURE;
				delay_ad9362(2000000 / DELAY_TRY_COUNT);
			}
		}
		//printf("WAIT_CALDONE	TXFILTER,2000 fail.");
		configStatus = XST_FAILURE;
	} else if (index == 6) {
		//WAIT_CALDONE	BBDC,2000
		// BBDC Max Cal Time: 6575.521 us. Cal done when 0x016[0]==0
		for (int i = 0; i < DELAY_TRY_COUNT; i++) {
			u32 reg = SPIRead(0x016);//0x0
			u8 checkbit = reg & (0x1 << 0);
			if (checkbit == 0) {
				waitcalStatus = XST_SUCCESS;
				return waitcalStatus;
			}
			else{
				waitcalStatus = XST_FAILURE;
				delay_ad9362(2000000 / DELAY_TRY_COUNT);
			}
		}
		//printf("WAIT_CALDONE	BBDC,2000 fail.");
		configStatus = XST_FAILURE;
	} else if (index == 7){		//fail 2
		//WAIT_CALDONE	RFDC,2000
		// Wait for cal to complete (Done when 0x016[1]==0)
		for (int i = 0; i < DELAY_TRY_COUNT; i++) {
			u32 reg = SPIRead(0x016);//0x0
			u8 checkbit = reg & (0x1 << 1);
			if (checkbit == 0) {
				waitcalStatus = XST_SUCCESS;
				return waitcalStatus;
			}
			else{
				waitcalStatus = XST_FAILURE;
				delay_ad9362(2000000 / DELAY_TRY_COUNT);
			}
		}
		//printf("WAIT_CALDONE	RFDC,2000 fail.");
		//configStatus = XST_FAILURE;
	} else if (index == 8) {
		//WAIT_CALDONE	TXQUAD,2000
		// Wait for cal to complete (Done when 0x016[4]==0)
		for (int i = 0; i < DELAY_TRY_COUNT; i++) {
			u32 reg = SPIRead(0x016);//0x0
			u8 checkbit = reg & (0x1 << 4);
			if (checkbit == 0) {
				waitcalStatus = XST_SUCCESS;
				return waitcalStatus;
			}
			else {
				waitcalStatus = XST_FAILURE;
				delay_ad9362(2000000 / DELAY_TRY_COUNT);
			}
		}
		//printf("WAIT_CALDONE	TXFILTER,2000 fail.");
		configStatus = XST_FAILURE;
	} else {
		//printf("for extention");
	}
}

int writeScriptEeprom() {
	int Status = 1;
	Write_Data(BaseAddr, I2CSelect, M24512);

	//insert LTE_eeprom_WR.txt and GSM_eeprom_WR.txt below


	//:end

	return Status;
}

void readScriptEeprom() {
	//reset ad9362
	reset_ad9362();

	chipSelect = 0x01;

	Write_Data(BaseAddr, I2CSelect, M24512);

	//初始化FPGA SPI控制器， Write 0x0024  0x0
	Write_Data(BaseAddr, 0x0024, 0xc);

	for (int i = 0x00; i <= 0x16c0; i += 0x4) {
		eeRdAD(i);
	}

	chipSelect = 0x02;
	for (int i = 0x16c4; i <= 0x3984; i += 0x4) {
		eeRdAD(i);
	}

}

void reset_ad9362()
{
	Write_Data(BaseAddr, 0x34, 0x0);
	Write_Data(BaseAddr, 0x34, 0x3);
}

 int ConfigAD9361LTE() {
	 reset_ad9362();
	 chipSelect = 0x01;
	 //初始化FPGA SPI控制器， Write 0x0024  0x0
	 Write_Data(BaseAddr, 0x0024, 0xc);


	 //Insert Covert_LTE_AD936X_40M.txt Scripts below.

	 SPIWrite(0x3DF,0x01);
	 SPIWrite(0x2A6,0x0E);
	 SPIWrite(0x2A8,0x0E);
	 SPIWrite(0x2AB,0x06);
	 SPIWrite(0x2AC,0x73);
	 SPIWrite(0x009,0x17);
	 delay_ad9362(20000);
	 SPIWrite(0x045,0x00);
	 SPIWrite(0x046,0x03);
	 SPIWrite(0x048,0xE8);
	 SPIWrite(0x049,0x5B);
	 SPIWrite(0x04A,0x35);
	 SPIWrite(0x04B,0xE0);
	 SPIWrite(0x04E,0x10);
	 SPIWrite(0x043,0x00);
	 SPIWrite(0x042,0x00);
	 SPIWrite(0x041,0x00);
	 SPIWrite(0x044,0x10);
	 SPIWrite(0x03F,0x05);
	 SPIWrite(0x03F,0x01);
	 SPIWrite(0x04C,0x86);
	 SPIWrite(0x04D,0x01);
	 SPIWrite(0x04D,0x05);
	 WAIT_CALDONE(1);
	 //WAIT_CALDONE	BBPLL,2000	// Wait for BBPLL to lock, Timeout 2sec, Max BBPLL VCO Cal Time: 225.000 us (Done when 0x05E[7]==1)
	 SPIRead_HLevel(0x05E);
	 SPIWrite(0x002,0xC6);
	 SPIWrite(0x003,0xCE);
	 SPIWrite(0x004,0x03);
	 SPIWrite(0x00A,0x09);
	 SPIWrite(0x065,0x7A);
	 delay_ad9362(1000);
	 SPIWrite(0x060,0x00);
	 SPIWrite(0x061,0xF6);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x01);
	 SPIWrite(0x061,0xA6);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x02);
	 SPIWrite(0x061,0x6A);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x03);
	 SPIWrite(0x061,0xF9);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x04);
	 SPIWrite(0x061,0x6F);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x05);
	 SPIWrite(0x061,0x68);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x06);
	 SPIWrite(0x061,0xA4);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x07);
	 SPIWrite(0x061,0xCE);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x08);
	 SPIWrite(0x061,0xF3);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x09);
	 SPIWrite(0x061,0xB7);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x0A);
	 SPIWrite(0x061,0xB9);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x0B);
	 SPIWrite(0x061,0x67);
	 SPIWrite(0x062,0xFE);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x0C);
	 SPIWrite(0x061,0x22);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x0D);
	 SPIWrite(0x061,0x27);
	 SPIWrite(0x062,0x01);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x0E);
	 SPIWrite(0x061,0x75);
	 SPIWrite(0x062,0x02);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x0F);
	 SPIWrite(0x061,0x9A);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x10);
	 SPIWrite(0x061,0x66);
	 SPIWrite(0x062,0xFD);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x11);
	 SPIWrite(0x061,0xA5);
	 SPIWrite(0x062,0xFC);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x12);
	 SPIWrite(0x061,0x69);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x13);
	 SPIWrite(0x061,0xBF);
	 SPIWrite(0x062,0x04);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x14);
	 SPIWrite(0x061,0xFC);
	 SPIWrite(0x062,0x03);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x15);
	 SPIWrite(0x061,0x64);
	 SPIWrite(0x062,0xFD);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x16);
	 SPIWrite(0x061,0x49);
	 SPIWrite(0x062,0xF8);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x17);
	 SPIWrite(0x061,0x21);
	 SPIWrite(0x062,0xFC);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x18);
	 SPIWrite(0x061,0xCD);
	 SPIWrite(0x062,0x06);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x19);
	 SPIWrite(0x061,0xE0);
	 SPIWrite(0x062,0x0B);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x1A);
	 SPIWrite(0x061,0x01);
	 SPIWrite(0x062,0x02);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x1B);
	 SPIWrite(0x061,0x62);
	 SPIWrite(0x062,0xF0);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x1C);
	 SPIWrite(0x061,0xA3);
	 SPIWrite(0x062,0xEC);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x1D);
	 SPIWrite(0x061,0x9E);
	 SPIWrite(0x062,0x06);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x1E);
	 SPIWrite(0x061,0x87);
	 SPIWrite(0x062,0x35);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x1F);
	 SPIWrite(0x061,0xB5);
	 SPIWrite(0x062,0x5A);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x20);
	 SPIWrite(0x061,0xB5);
	 SPIWrite(0x062,0x5A);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x21);
	 SPIWrite(0x061,0x87);
	 SPIWrite(0x062,0x35);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x22);
	 SPIWrite(0x061,0x9E);
	 SPIWrite(0x062,0x06);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x23);
	 SPIWrite(0x061,0xA3);
	 SPIWrite(0x062,0xEC);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x24);
	 SPIWrite(0x061,0x62);
	 SPIWrite(0x062,0xF0);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x25);
	 SPIWrite(0x061,0x01);
	 SPIWrite(0x062,0x02);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x26);
	 SPIWrite(0x061,0xE0);
	 SPIWrite(0x062,0x0B);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x27);
	 SPIWrite(0x061,0xCD);
	 SPIWrite(0x062,0x06);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x28);
	 SPIWrite(0x061,0x21);
	 SPIWrite(0x062,0xFC);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x29);
	 SPIWrite(0x061,0x49);
	 SPIWrite(0x062,0xF8);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x2A);
	 SPIWrite(0x061,0x64);
	 SPIWrite(0x062,0xFD);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x2B);
	 SPIWrite(0x061,0xFC);
	 SPIWrite(0x062,0x03);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x2C);
	 SPIWrite(0x061,0xBF);
	 SPIWrite(0x062,0x04);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x2D);
	 SPIWrite(0x061,0x69);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x2E);
	 SPIWrite(0x061,0xA5);
	 SPIWrite(0x062,0xFC);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x2F);
	 SPIWrite(0x061,0x66);
	 SPIWrite(0x062,0xFD);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x30);
	 SPIWrite(0x061,0x9A);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x31);
	 SPIWrite(0x061,0x75);
	 SPIWrite(0x062,0x02);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x32);
	 SPIWrite(0x061,0x27);
	 SPIWrite(0x062,0x01);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x33);
	 SPIWrite(0x061,0x22);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x34);
	 SPIWrite(0x061,0x67);
	 SPIWrite(0x062,0xFE);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x35);
	 SPIWrite(0x061,0xB9);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x36);
	 SPIWrite(0x061,0xB7);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x37);
	 SPIWrite(0x061,0xF3);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x38);
	 SPIWrite(0x061,0xCE);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x39);
	 SPIWrite(0x061,0xA4);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x3A);
	 SPIWrite(0x061,0x68);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x3B);
	 SPIWrite(0x061,0x6F);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x3C);
	 SPIWrite(0x061,0xF9);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x3D);
	 SPIWrite(0x061,0x6A);
	 SPIWrite(0x062,0x00);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x3E);
	 SPIWrite(0x061,0xA6);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x060,0x3F);
	 SPIWrite(0x061,0xF6);
	 SPIWrite(0x062,0xFF);
	 SPIWrite(0x065,0x7E);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x064,0x00);
	 SPIWrite(0x065,0x78);
	 SPIWrite(0x0F5,0x7A);
	 SPIWrite(0x0F6,0x02);
	 delay_ad9362(1000);
	 SPIWrite(0x0F0,0x00);
	 SPIWrite(0x0F1,0xA7);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x01);
	 SPIWrite(0x0F1,0x59);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x02);
	 SPIWrite(0x0F1,0x11);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x03);
	 SPIWrite(0x0F1,0x63);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x04);
	 SPIWrite(0x0F1,0x98);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x05);
	 SPIWrite(0x0F1,0x93);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x06);
	 SPIWrite(0x0F1,0xB7);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x07);
	 SPIWrite(0x0F1,0xB3);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x08);
	 SPIWrite(0x0F1,0xDA);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x09);
	 SPIWrite(0x0F1,0x20);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x0A);
	 SPIWrite(0x0F1,0xC2);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x0B);
	 SPIWrite(0x0F1,0xBB);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x0C);
	 SPIWrite(0x0F1,0x48);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x0D);
	 SPIWrite(0x0F1,0x1C);
	 SPIWrite(0x0F2,0x02);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x0E);
	 SPIWrite(0x0F1,0xA9);
	 SPIWrite(0x0F2,0x01);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x0F);
	 SPIWrite(0x0F1,0xF2);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x10);
	 SPIWrite(0x0F1,0xAF);
	 SPIWrite(0x0F2,0xFC);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x11);
	 SPIWrite(0x0F1,0x21);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x12);
	 SPIWrite(0x0F1,0x6F);
	 SPIWrite(0x0F2,0x02);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x13);
	 SPIWrite(0x0F1,0xF1);
	 SPIWrite(0x0F2,0x04);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x14);
	 SPIWrite(0x0F1,0xBA);
	 SPIWrite(0x0F2,0x01);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x15);
	 SPIWrite(0x0F1,0x41);
	 SPIWrite(0x0F2,0xFB);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x16);
	 SPIWrite(0x0F1,0xE2);
	 SPIWrite(0x0F2,0xF8);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x17);
	 SPIWrite(0x0F1,0x23);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x18);
	 SPIWrite(0x0F1,0xC7);
	 SPIWrite(0x0F2,0x08);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x19);
	 SPIWrite(0x0F1,0x60);
	 SPIWrite(0x0F2,0x0A);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x1A);
	 SPIWrite(0x0F1,0x6B);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x1B);
	 SPIWrite(0x0F1,0xAF);
	 SPIWrite(0x0F2,0xEE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x1C);
	 SPIWrite(0x0F1,0xB6);
	 SPIWrite(0x0F2,0xEE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x1D);
	 SPIWrite(0x0F1,0x2F);
	 SPIWrite(0x0F2,0x0A);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x1E);
	 SPIWrite(0x0F1,0xCA);
	 SPIWrite(0x0F2,0x36);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x1F);
	 SPIWrite(0x0F1,0xE7);
	 SPIWrite(0x0F2,0x58);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x20);
	 SPIWrite(0x0F1,0xE7);
	 SPIWrite(0x0F2,0x58);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x21);
	 SPIWrite(0x0F1,0xCA);
	 SPIWrite(0x0F2,0x36);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x22);
	 SPIWrite(0x0F1,0x2F);
	 SPIWrite(0x0F2,0x0A);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x23);
	 SPIWrite(0x0F1,0xB6);
	 SPIWrite(0x0F2,0xEE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x24);
	 SPIWrite(0x0F1,0xAF);
	 SPIWrite(0x0F2,0xEE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x25);
	 SPIWrite(0x0F1,0x6B);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x26);
	 SPIWrite(0x0F1,0x60);
	 SPIWrite(0x0F2,0x0A);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x27);
	 SPIWrite(0x0F1,0xC7);
	 SPIWrite(0x0F2,0x08);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x28);
	 SPIWrite(0x0F1,0x23);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x29);
	 SPIWrite(0x0F1,0xE2);
	 SPIWrite(0x0F2,0xF8);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x2A);
	 SPIWrite(0x0F1,0x41);
	 SPIWrite(0x0F2,0xFB);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x2B);
	 SPIWrite(0x0F1,0xBA);
	 SPIWrite(0x0F2,0x01);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x2C);
	 SPIWrite(0x0F1,0xF1);
	 SPIWrite(0x0F2,0x04);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x2D);
	 SPIWrite(0x0F1,0x6F);
	 SPIWrite(0x0F2,0x02);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x2E);
	 SPIWrite(0x0F1,0x21);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x2F);
	 SPIWrite(0x0F1,0xAF);
	 SPIWrite(0x0F2,0xFC);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x30);
	 SPIWrite(0x0F1,0xF2);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x31);
	 SPIWrite(0x0F1,0xA9);
	 SPIWrite(0x0F2,0x01);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x32);
	 SPIWrite(0x0F1,0x1C);
	 SPIWrite(0x0F2,0x02);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x33);
	 SPIWrite(0x0F1,0x48);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x34);
	 SPIWrite(0x0F1,0xBB);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x35);
	 SPIWrite(0x0F1,0xC2);
	 SPIWrite(0x0F2,0xFE);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x36);
	 SPIWrite(0x0F1,0x20);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x37);
	 SPIWrite(0x0F1,0xDA);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x38);
	 SPIWrite(0x0F1,0xB3);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x39);
	 SPIWrite(0x0F1,0xB7);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x3A);
	 SPIWrite(0x0F1,0x93);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x3B);
	 SPIWrite(0x0F1,0x98);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x3C);
	 SPIWrite(0x0F1,0x63);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x3D);
	 SPIWrite(0x0F1,0x11);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x3E);
	 SPIWrite(0x0F1,0x59);
	 SPIWrite(0x0F2,0x00);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F0,0x3F);
	 SPIWrite(0x0F1,0xA7);
	 SPIWrite(0x0F2,0xFF);
	 SPIWrite(0x0F5,0x7E);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F4,0x00);
	 SPIWrite(0x0F5,0x78);
	 SPIWrite(0x010,0xCC);
	 SPIWrite(0x011,0x00);
	 SPIWrite(0x012,0x10);
	 SPIWrite(0x006,0x06);
	 SPIWrite(0x007,0x03);
	 SPIWrite(0x03C,0x25);
	 SPIWrite(0x03D,0xFF);
	 SPIWrite(0x03E,0x0F);
	 SPIWrite(0x018,0x00);
	 SPIWrite(0x019,0x00);
	 SPIWrite(0x01A,0x37);
	 SPIWrite(0x01B,0x37);
	 SPIWrite(0x023,0x3C);
	 SPIWrite(0x026,0x80);
	 SPIWrite(0x030,0x00);
	 SPIWrite(0x031,0x00);
	 SPIWrite(0x032,0x00);
	 SPIWrite(0x033,0x00);
	 SPIWrite(0x00B,0x00);
	 SPIWrite(0x00C,0x00);
	 SPIWrite(0x00D,0x03);
	 SPIWrite(0x00F,0x04);
	 SPIWrite(0x01C,0x10);
	 SPIWrite(0x01D,0x01);
	 SPIWrite(0x035,0x00);
	 SPIWrite(0x036,0xFF);
	 SPIWrite(0x03A,0x7A);
	 SPIWrite(0x020,0x00);
	 SPIWrite(0x027,0x03);
	 SPIWrite(0x028,0x00);
	 SPIWrite(0x029,0x00);
	 SPIWrite(0x02A,0x00);
	 SPIWrite(0x02B,0x00);
	 SPIWrite(0x02C,0x00);
	 SPIWrite(0x02D,0x00);
	 SPIWrite(0x02E,0x00);
	 SPIWrite(0x02F,0x00);
	 SPIWrite(0x261,0x00);
	 SPIWrite(0x2A1,0x00);
	 SPIWrite(0x248,0x0B);
	 SPIWrite(0x288,0x0B);
	 SPIWrite(0x246,0x02);
	 SPIWrite(0x286,0x02);
	 SPIWrite(0x249,0x8E);
	 SPIWrite(0x289,0x8E);
	 SPIWrite(0x23B,0x80);
	 SPIWrite(0x27B,0x80);
	 SPIWrite(0x243,0x0D);
	 SPIWrite(0x283,0x0D);
	 SPIWrite(0x23D,0x00);
	 SPIWrite(0x27D,0x00);
	 SPIWrite(0x015,0x04);
	 SPIWrite(0x014,0x05);
	 SPIWrite(0x013,0x01);
	 delay_ad9362(1000);
	 SPIWrite(0x23D,0x04);
	 WAIT_CALDONE(2);
	 //WAIT_CALDONE	RXCP,100	// Wait for CP cal to complete, Max RXCP Cal time: 600.000 (us)(Done when 0x244[7]==1)
	 SPIWrite(0x27D,0x04);
	 WAIT_CALDONE(3);
	 //WAIT_CALDONE	TXCP,100	// Wait for CP cal to complete, Max TXCP Cal time: 600.000 (us)(Done when 0x284[7]==1)
	 SPIWrite(0x23D,0x00);
	 SPIWrite(0x27D,0x00);
	 SPIWrite(0x23A,0x4A);
	 SPIWrite(0x239,0xC0);
	 SPIWrite(0x242,0x0D);
	 SPIWrite(0x238,0x70);
	 SPIWrite(0x245,0x00);
	 SPIWrite(0x251,0x09);
	 SPIWrite(0x250,0x70);
	 SPIWrite(0x23B,0x94);
	 SPIWrite(0x23E,0xF4);
	 SPIWrite(0x23F,0xDF);
	 SPIWrite(0x240,0x0A);
	 SPIWrite(0x27A,0x4A);
	 SPIWrite(0x279,0xC0);
	 SPIWrite(0x282,0x0D);
	 SPIWrite(0x278,0x70);
	 SPIWrite(0x285,0x00);
	 SPIWrite(0x291,0x09);
	 SPIWrite(0x290,0x70);
	 SPIWrite(0x27B,0x94);
	 SPIWrite(0x27E,0xF4);
	 SPIWrite(0x27F,0xDF);
	 SPIWrite(0x280,0x0A);
	 SPIWrite(0x233,0x4C);
	 SPIWrite(0x234,0x55);
	 SPIWrite(0x235,0x4D);
	 SPIWrite(0x232,0x00);
	 SPIWrite(0x231,0x98);
	 SPIWrite(0x005,0x11);
	 SPIWrite(0x273,0x4C);
	 SPIWrite(0x274,0x55);
	 SPIWrite(0x275,0x4D);
	 SPIWrite(0x272,0x00);
	 SPIWrite(0x271,0x98);
	 SPIWrite(0x005,0x11);
	 SPIRead_HLevel(0x247);
	 SPIRead_HLevel(0x287);
	 SPIWrite(0x13F,0x02);
	 SPIWrite(0x138,0x0F);
	 SPIWrite(0x139,0x78);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x00);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x0E);
	 SPIWrite(0x139,0x74);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x0D);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x0D);
	 SPIWrite(0x139,0x70);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x15);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x0C);
	 SPIWrite(0x139,0x6C);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x1B);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x0B);
	 SPIWrite(0x139,0x68);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x21);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x0A);
	 SPIWrite(0x139,0x64);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x25);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x09);
	 SPIWrite(0x139,0x60);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x29);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x08);
	 SPIWrite(0x139,0x5C);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x2C);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x07);
	 SPIWrite(0x139,0x58);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x2F);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x06);
	 SPIWrite(0x139,0x54);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x31);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x05);
	 SPIWrite(0x139,0x50);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x33);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x04);
	 SPIWrite(0x139,0x4C);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x34);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x03);
	 SPIWrite(0x139,0x48);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x35);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x02);
	 SPIWrite(0x139,0x30);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x3A);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x01);
	 SPIWrite(0x139,0x18);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x3D);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x138,0x00);
	 SPIWrite(0x139,0x00);
	 SPIWrite(0x13A,0x00);
	 SPIWrite(0x13B,0x3E);
	 SPIWrite(0x13F,0x06);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13F,0x02);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13C,0x00);
	 SPIWrite(0x13F,0x00);
	 SPIWrite(0x137,0x1A);
	 SPIWrite(0x130,0x00);
	 SPIWrite(0x131,0x00);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x01);
	 SPIWrite(0x131,0x00);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x00);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x02);
	 SPIWrite(0x131,0x00);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x00);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x03);
	 SPIWrite(0x131,0x00);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x00);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x04);
	 SPIWrite(0x131,0x00);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x00);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x05);
	 SPIWrite(0x131,0x00);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x00);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x06);
	 SPIWrite(0x131,0x00);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x00);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x07);
	 SPIWrite(0x131,0x00);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x08);
	 SPIWrite(0x131,0x01);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x09);
	 SPIWrite(0x131,0x02);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x0A);
	 SPIWrite(0x131,0x04);
	 SPIWrite(0x132,0x18);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x0B);
	 SPIWrite(0x131,0x04);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x0C);
	 SPIWrite(0x131,0x05);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x0D);
	 SPIWrite(0x131,0x06);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x0E);
	 SPIWrite(0x131,0x07);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x0F);
	 SPIWrite(0x131,0x08);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x10);
	 SPIWrite(0x131,0x09);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x11);
	 SPIWrite(0x131,0x0A);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x12);
	 SPIWrite(0x131,0x0B);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x13);
	 SPIWrite(0x131,0x0C);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x14);
	 SPIWrite(0x131,0x0D);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x15);
	 SPIWrite(0x131,0x0E);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x16);
	 SPIWrite(0x131,0x0F);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x17);
	 SPIWrite(0x131,0x25);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x18);
	 SPIWrite(0x131,0x26);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x19);
	 SPIWrite(0x131,0x44);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x1A);
	 SPIWrite(0x131,0x45);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x1B);
	 SPIWrite(0x131,0x46);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x1C);
	 SPIWrite(0x131,0x47);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x1D);
	 SPIWrite(0x131,0x64);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x1E);
	 SPIWrite(0x131,0x65);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x1F);
	 SPIWrite(0x131,0x66);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x20);
	 SPIWrite(0x131,0x67);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x21);
	 SPIWrite(0x131,0x68);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x22);
	 SPIWrite(0x131,0x69);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x23);
	 SPIWrite(0x131,0x6A);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x24);
	 SPIWrite(0x131,0x6B);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x25);
	 SPIWrite(0x131,0x6C);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x26);
	 SPIWrite(0x131,0x6D);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x27);
	 SPIWrite(0x131,0x6E);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x130,0x28);
	 SPIWrite(0x131,0x6F);
	 SPIWrite(0x132,0x38);
	 SPIWrite(0x133,0x20);
	 SPIWrite(0x137,0x1E);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x137,0x1A);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x134,0x00);
	 SPIWrite(0x137,0x00);
	 SPIWrite(0x0FA,0xE0);
	 SPIWrite(0x0FB,0x00);
	 SPIWrite(0x0FC,0x23);
	 SPIWrite(0x0FD,0x28);
	 SPIWrite(0x0FE,0x44);
	 SPIWrite(0x100,0x6F);
	 SPIWrite(0x104,0x2F);
	 SPIWrite(0x105,0x3A);
	 SPIWrite(0x107,0x2B);
	 SPIWrite(0x108,0x31);
	 SPIWrite(0x109,0x14);
	 SPIWrite(0x10A,0x00);
	 SPIWrite(0x10B,0x00);
	 SPIWrite(0x10C,0x14);
	 SPIWrite(0x10D,0x00);
	 SPIWrite(0x10E,0x00);
	 SPIWrite(0x114,0x64);
	 SPIWrite(0x11A,0x27);
	 SPIWrite(0x081,0x00);
	 SPIWrite(0x1FB,0x14);
	 SPIWrite(0x1FC,0x00);
	 SPIWrite(0x1F8,0x04);
	 SPIWrite(0x1F9,0x1E);
	 SPIWrite(0x1D5,0x3F);
	 SPIWrite(0x1C0,0x03);
	 SPIWrite(0x1E2,0x02);
	 SPIWrite(0x1E3,0x02);
	 SPIWrite(0x016,0x80);
	 WAIT_CALDONE(4);
	 //WAIT_CALDONE	RXFILTER,2000	// Wait for RX filter to tune, Max Cal Time: 3.103 us (Done when 0x016[7]==0)
	 SPIWrite(0x1E2,0x03);
	 SPIWrite(0x1E3,0x03);
	 SPIWrite(0x0D6,0x04);
	 SPIWrite(0x0D7,0x1E);
	 SPIWrite(0x0CA,0x22);
	 SPIWrite(0x016,0x40);
	 WAIT_CALDONE(5);
	 //WAIT_CALDONE	TXFILTER,2000	// Wait for TX filter to tune, Max Cal Time: 1.444 us (Done when 0x016[6]==0)
	 SPIWrite(0x0CA,0x26);
	 SPIRead_HLevel(0x1EB);
	 SPIRead_HLevel(0x1EC);
	 SPIRead_HLevel(0x1E6);
	 SPIWrite(0x1DB,0x20);
	 SPIWrite(0x1DD,0x00);
	 SPIWrite(0x1DF,0x00);
	 SPIWrite(0x1DC,0x4b);//SPIWrite(0x1DC,0x47);
	 SPIWrite(0x1DE,0x4b);//SPIWrite(0x1DE,0x47);
	 SPIWrite(0x0D2,0x04);
	 SPIWrite(0x0D1,0x0C);
	 SPIWrite(0x0D0,0x57);
	 SPIRead_HLevel(0x1EB);
	 SPIRead_HLevel(0x1EC);
	 SPIRead_HLevel(0x1E6);
	 SPIWrite(0x200,0x00);
	 SPIWrite(0x201,0x00);
	 SPIWrite(0x202,0x00);
	 SPIWrite(0x203,0x24);
	 SPIWrite(0x204,0x24);
	 SPIWrite(0x205,0x00);
	 SPIWrite(0x206,0x00);
	 SPIWrite(0x207,0x7B);//SPIWrite(0x207,0x6B);
	 /*SPIWrite(0x208,0x30);
	 SPIWrite(0x209,0x34);
	 SPIWrite(0x20A,0x41);
	 SPIWrite(0x20B,0x1E);
	 SPIWrite(0x20C,0x43);*/
	 SPIWrite(0x208,0x2a);
	 SPIWrite(0x209,0x3b);
	 SPIWrite(0x20A,0x4a);
	 SPIWrite(0x20B,0x1a);
	 SPIWrite(0x20C,0x4d);
	 /*SPIWrite(0x20D,0x1C);
	 SPIWrite(0x20E,0x00);
	 SPIWrite(0x20F,0x6E);
	 SPIWrite(0x210,0x6E);
	 SPIWrite(0x211,0x6E);*/
	 SPIWrite(0x20D,0x18);
	 SPIWrite(0x20E,0x00);
	 SPIWrite(0x20F,0x7E);
	 SPIWrite(0x210,0x7e);
	 SPIWrite(0x211,0x7e);
	 /*SPIWrite(0x212,0x3F);
	 SPIWrite(0x213,0x3F);
	 SPIWrite(0x214,0x3F);
	 SPIWrite(0x215,0x41);
	 SPIWrite(0x216,0x41);*/
	 SPIWrite(0x212,0x48);
	 SPIWrite(0x213,0x48);
	 SPIWrite(0x214,0x48);
	 SPIWrite(0x215,0x4b);
	 SPIWrite(0x216,0x4b);
	 SPIWrite(0x217,0x4b);//SPIWrite(0x217,0x41);
	 SPIWrite(0x218,0x2E);
	 SPIWrite(0x219,0xB0);
	 SPIWrite(0x21A,0x31);
	 SPIWrite(0x21B,0x1C);
	 SPIWrite(0x21C,0xB0);
	 SPIWrite(0x21D,0x31);
	 SPIWrite(0x21E,0x1C);
	 SPIWrite(0x21F,0xB0);
	 SPIWrite(0x220,0x31);
	 SPIWrite(0x221,0x37);
	 SPIWrite(0x222,0x38);
	 SPIWrite(0x223,0x40);
	 SPIWrite(0x224,0x40);
	 SPIWrite(0x225,0x2C);
	 SPIWrite(0x226,0x00);
	 SPIWrite(0x227,0x00);
	 SPIRead_HLevel(0x0A3);
	 SPIWrite(0x0A0,0x15);
	 SPIWrite(0x0A3,0x00);
	 SPIWrite(0x0A1,0x7B);
	 SPIWrite(0x0AC,0x0B);
	 SPIWrite(0x0A9,0xFF);
	 SPIWrite(0x0A2,0x7F);
	 SPIWrite(0x0A5,0x01);
	 SPIWrite(0x0A6,0x01);
	 SPIWrite(0x0AA,0x1D);
	 SPIWrite(0x0A4,0xF0);
	 SPIWrite(0x0AE,0x00);
	 SPIWrite(0x193,0x3F);
	 SPIWrite(0x190,0x0F);
	 SPIWrite(0x194,0x01);
	 SPIWrite(0x016,0x01);
	 WAIT_CALDONE(6);
	 //WAIT_CALDONE	BBDC,2000	// BBDC Max Cal Time: 3287.760 us. Cal done when 0x016[0]==0
	 SPIWrite(0x185,0x20);
	 SPIWrite(0x186,0x32);
	 SPIWrite(0x187,0x24);
	 SPIWrite(0x18B,0x83);
	 SPIWrite(0x188,0x05);
	 SPIWrite(0x189,0x30);
	 SPIWrite(0x016,0x02);
	 WAIT_CALDONE(7);
	 //WAIT_CALDONE	RFDC,2000	// RFDC Max Cal Time: 44730.957 us
	 SPIWrite(0x169,0xC0);
	 SPIWrite(0x016,0x10);
	 WAIT_CALDONE(8);
	 //WAIT_CALDONE	TXQUAD,2000	// Wait for cal to complete (Done when 0x016[4]==0)
	 SPIWrite(0x168,0x00);
	 SPIWrite(0x16E,0x0B);
	 SPIWrite(0x16A,0x75);
	 SPIWrite(0x16B,0x95);
	 SPIWrite(0x169,0xCF);
	 SPIWrite(0x18B,0xAD);
	 SPIWrite(0x012,0x10);
	 SPIWrite(0x013,0x01);
	 SPIWrite(0x015,0x04);
	 SPIWrite(0x073,0xFF);
	 SPIWrite(0x074,0x00);
	 SPIWrite(0x075,0xFF);
	 SPIWrite(0x076,0x00);
	 SPIWrite(0x077,0x40);
	 SPIWrite(0x07C,0x40);
	 SPIWrite(0x150,0x0E);
	 SPIWrite(0x151,0x00);
	 SPIWrite(0x152,0xFF);
	 SPIWrite(0x153,0x00);
	 SPIWrite(0x154,0x00);
	 SPIWrite(0x155,0x00);
	 SPIWrite(0x156,0x00);
	 SPIWrite(0x157,0x00);
	 SPIWrite(0x158,0x0D);
	 SPIWrite(0x15C,0x67);
	 SPIWrite(0x002,0xC6);
	 SPIWrite(0x003,0xCE);
	 SPIWrite(0x014,0x21);


	 //:end Scripts
	 //0x73 0x0b
	 SPIWrite(0x073,0x0b);
	 //0x75 0x08
	 SPIWrite(0x075,0x08);

	 return configStatus;
 }

 int ConfigAD9361GSM() {
 chipSelect = 0x02;

 //初始化FPGA SPI控制器， Write 0x0024  0x0
 Write_Data(BaseAddr, 0x0024, 0xc);

 //Insert Covert_GSM_AD80305.txt Scripts below.


 //:end Scripts

 return configStatus;
 }

